
###HalfSib
Sib<-read.csv(choose.files()) #read in output from COLONY

SiteLoc<-read.csv(choose.files()) #Read in Georeferenced Individuals with Site ID
head(SiteLoc)
dim(SiteLoc)

IndSite<-cbind(SiteLoc[,1:2],SiteLoc[,34:35]) #subset to Ind, Site, and XY

head(IndSite)
head(Sib)

names(Sib)<-c("ID","ID2","Probability")

SibLoc<-merge(Sib,IndSite,by="ID") #merge COLONY and XY file
names(SibLoc)<-c("Off1","ID","Probability","Pop1","X1","Y1") #rename so offspring 2 can be merged with XY data
SibLocFull<-merge(SibLoc,IndSite,by="ID") #get the georeference of Offspring 2
head(SibLocFull)

write.csv(SibLocFull,"C:\\Users\\nba52\\Desktop\\SibPops.csv") #write CSV and re-order by Offspring 1


SibPops<-read.csv(choose.files()) #read in ordered dataframe
head(SibPops)
SibProb<-SibPops[which(SibPops$Probability>=.95),] #require the probability of halfsibs to be >.95
head(SibProb)
dim(SibPops)
dim(SibProb)
SibProb
Coords1<-cbind(SibPops$X1,SibPops$Y1)
Coords2<-cbind(SibPops$X2,SibPops$Y2)

plot(Coords1,xlab="Decimal Longitude",ylab="Decimal Latitude") #plot the locations
plot(Coords2,add=TRUE,pch=17,label="Pop2")
segments(SibProb$X1,SibProb$Y1,SibProb$X2,SibProb$Y2,lty=3,lwd=2) #add in dashed lines between half-sibs

###Full Sib ## same steps as halfsib, but change line weighting to be darker
Fsib<-read.csv(choose.files())
head(Fsib)
names(Fsib)<-c("ID","ID2","Prob")
FsibP1<-merge(Fsib,IndSite,by="ID")
head(FsibP1)
names(FsibP1)<-c("Off1","ID","P","Pop1","X1","Y1")
Fsib2<-merge(FsibP1,IndSite,by="ID")
head(Fsib2)
names(Fsib2)<-c("Off2","Off1","Probability","Pop1","X1","Y1","Pop2","X2","Y2")
head(Fsib2)
Fsibling<-Fsib2[which(Fsib2$Probability>=.95),]
Fsib2
Fsibling
Coords<-cbind(unique(Coords1),unique(SibProb$Pop1))
length(unique(SibProb$Pop1))
head(Coords)
dim(Coords1)
segments(Fsibling$X1,Fsibling$Y1,Fsibling$X2,Fsibling$Y2,lty=1,lwd=3)
